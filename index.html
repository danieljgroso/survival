<script>
  const players = ["Daniel", "Claudia"];
  let currentPlayerIndex = 0;
  let current = 0;
  let chaosScore = 0;
  let selectedScenarios = [];

  // âœ… Define scenarios first
  const scenarios = [
    {
      text: "ðŸ§Ÿ You wake up to find zombies outside. Your partner is brushing their teeth. What do you do?",
      choices: [
        { text: "Grab your partnerâ€™s hand and run. No time to rinse.", result: "You both survive but she resents the minty injustice. ðŸ’”", chaos: 2 },
        { text: "Let them rinse while you brew coffee real quick.", result: "You nearly die, but you're caffeinated. â˜• + ðŸ˜˜", chaos: 3 },
        { text: "Hide in the laundry basket together.", result: "You both smell like lavender. Zombies ignore you. +2 stealth. ðŸ™ˆ", chaos: -1 },
        { text: "Ask the zombies if theyâ€™ve seen your neighbor Carl.", result: "They groan. You groan. Itâ€™s a bonding moment. ðŸ§Ÿâ€â™‚ï¸ðŸ§Ÿâ€â™€ï¸", chaos: 1 },
        { text: "Turn on music and try to distract them with a dance party.", result: "Zombies start doing the Macarena. You escape mid-dance. ðŸ•ºðŸ§Ÿ", chaos: 0 }
      ]
    },
    {
      text: "ðŸ›¸ Aliens land and demand your best couple's TikTok dance. What now?",
      choices: [
        { text: "Nail the Cupid Shuffle with zero coordination.", result: "Aliens love it. Your rhythm? Not so much. ðŸ‘½âœ¨", chaos: 0 },
        { text: "You panic and do The Worm alone.", result: "She laughs so hard she forgets the aliens. ðŸ’•", chaos: -1 },
        { text: "You both freeze and awkwardly wave.", result: "Aliens assume you're diplomats. ðŸ›¸ðŸŒŽ", chaos: -2 },
        { text: "Start flossing â€” she's mortified.", result: "She considers single status. Aliens vibe with you though. ðŸ¤–", chaos: 3 },
        { text: "Claudia starts beatboxing while Daniel breakdances.", result: "Aliens declare you rulers of Earth. ðŸ•¶ï¸ðŸŒ", chaos: 1 }
      ]
    },
    // âœ… (Include the rest of your scenarios here...)
  ];

  // âœ… Now you can safely create allScenarios
  const allScenarios = scenarios.concat([
    {
      text: "ðŸ§Š The fridge breaks and your ice cream is melting. Whatâ€™s your move?",
      choices: [
        { text: "Eat everything immediately.", result: "Glorious chaos. You regret nothing. ðŸ¦ðŸ”¥", chaos: 2 },
        { text: "Call the landlord mid-scoop.", result: "They put you on hold. Ice cream soup it is. ðŸ“žðŸ¨", chaos: 1 },
        { text: "Use the ice cream to barter with neighbors.", result: "Now youâ€™re local royalty. ðŸ¦ðŸ‘‘", chaos: -1 },
        { text: "Make Claudia try every flavor blindfolded.", result: "She loves it... until durian hits. ðŸ˜¬", chaos: 1 },
        { text: "Freeze it outside â€” itâ€™s Miami, what could go wrong?", result: "Everything melted. Nice try. ðŸŒ´ðŸ˜…", chaos: 2 }
      ]
    },
    // âœ… Add more fun extra scenarios here
  ]);

  function getRandomScenarios(pool, count) {
    const shuffled = [...pool].sort(() => 0.5 - Math.random());
    return shuffled.slice(0, count);
  }

  function startGame() {
    document.getElementById('bg-music').play();
    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('turn').classList.remove('hidden');
    document.getElementById('scenario').classList.remove('hidden');
    document.getElementById('choices').classList.remove('hidden');
    document.getElementById('result').classList.remove('hidden');
    document.getElementById('score').classList.remove('hidden');
    document.getElementById('replay').classList.add('hidden');

    chaosScore = 0;
    current = 0;
    currentPlayerIndex = 0;
    selectedScenarios = getRandomScenarios(allScenarios, 5); // âœ… Use allScenarios
    renderScenario();
  }

  function renderScenario() {
    const s = selectedScenarios[current];
    document.getElementById('scenario').textContent = s.text;
    document.getElementById('turn').textContent = `ðŸŽ² It's ${players[currentPlayerIndex]}'s turn!`;
    const choicesDiv = document.getElementById('choices');
    const resultDiv = document.getElementById('result');
    resultDiv.textContent = '';
    choicesDiv.innerHTML = '';

    s.choices.forEach(choice => {
      const btn = document.createElement('button');
      btn.textContent = choice.text;
      btn.onclick = () => {
        document.getElementById('choice-sound').play();
        resultDiv.textContent = choice.result;
        chaosScore += choice.chaos;
        document.getElementById('score').textContent = `ðŸ§  Chaos Score: ${chaosScore}`;

        setTimeout(() => {
          current++;
          currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
          if (current < selectedScenarios.length) {
            renderScenario();
          } else {
            endGame();
          }
        }, 1500);
      };
      choicesDiv.appendChild(btn);
    });
  }

  function endGame() {
    document.getElementById('end-sound').play();
    document.getElementById('scenario').textContent = "ðŸŽ‰ Game Over!";
    document.getElementById('turn').textContent = '';
    document.getElementById('choices').innerHTML = '';

    let verdict = "";
    if (chaosScore <= -3) {
      verdict = "ðŸ§Š Ice cold. Calm under pressure. Unshakable energy.";
    } else if (chaosScore <= 0) {
      verdict = "ðŸƒ You kept it chill. Peaceful vibes all around.";
    } else if (chaosScore <= 3) {
      verdict = "ðŸŽ¢ Some bumps, but youâ€™re vibing through the mayhem.";
    } else if (chaosScore <= 6) {
      verdict = "ðŸ”¥ Things got spicy! You brought the drama.";
    } else if (chaosScore <= 10) {
      verdict = "ðŸ”¥ Mild-to-medium chaos â€” spicy, but survivable!";
    } else {
      verdict = "ðŸ’¥ You two are a beautiful disaster. We love to see it.";
    }

    document.getElementById('result').innerHTML = `<strong>Your final chaos score is: ${chaosScore}</strong><br><em>${verdict}</em>`;
    document.getElementById('replay').classList.remove('hidden');
  }
</script>
</body>
</html>
